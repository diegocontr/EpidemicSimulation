#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Thu Dec  2 18:07:40 2021

@author: diego
"""

import numpy as np

DictFit_office_rperiod_15 ={1: {'CM': (19.314114506843403, 6.7935621101888515),
  'CMB': (13.799112953900947, 9.513454461534806),
  'CMD': (6.384051638248792, 20.308161363567905),
  'DYN': (5.587570099330365, 20.972697025572568),
  'FULL': (57.167797964080656, 2.319136988690571),
  'HET': (6.028721533733916, 19.899637394985458),
  'dHET': (5.520260494891922, 21.380728648316786)},
 2: {'CM': (5.915145053462929, 23.892793736041032),
  'CMB': (5.244278152258456, 27.558108432692368),
  'CMD': (4.380837559618035, 30.16276533482258),
  'DYN': (4.008457833558327, 35.61553027142463),
  'FULL': (12.935933820243733, 10.43441121347648),
  'HET': (4.1741804521102015, 36.29180604338513),
  'dHET': (4.141890646133727, 34.20656701765781)}}

DictFit_office_rperiod_05 = {1: {'CM': (27.523969890888946, 1.558306123476891),
  'CMB': (10.683684540529056, 4.017986070827603),
  'CMD': (3.91447585512742, 9.851769351252644),
  'DYN': (3.867508049900146, 9.242995788929539),
  'FULL': (334.6705726361985, 0.12903135779971664),
  'HET': (6.250939179596208, 6.4050670944647905),
  'dHET': (4.08051134089714, 8.992016140517752)},
 2: {'CM': (6.271964338590125, 7.3608899035712),
  'CMB': (5.15801182974471, 8.810832289096895),
  'CMD': (3.3681706566897316, 11.311933393759132),
  'DYN': (3.2290173134511493, 12.118766977599597),
  'FULL': (19.194493936177455, 2.260607460598957),
  'HET': (4.4601981136650615, 10.658584094319759),
  'dHET': (3.417104175305787, 11.35409491396868)}}

DictFit_office_rperiod_025 = {1: {'CM': (19.207031745917526, 1.1358922838500114),
  'CMB': (6.823440402804128, 3.139254027218574),
  'CMD': (2.7541055064543727, 6.144865993430297),
  'DYN': (2.8771392577785186, 5.626463182629948),
  'FULL': (6773.658620906997, 0.0032079809149049517),
  'HET': (5.771394477101178, 3.5053914767327132),
  'dHET': (3.1645310062180587, 5.3890593874791985)},
 2: {'CM': (5.628201088873889, 3.892925943512594),
  'CMB': (4.283130035817466, 4.900897232815402),
  'CMD': (2.4066363243838076, 6.9221670319835855),
  'DYN': (2.476583769243269, 6.6241645061981105),
  'FULL': (20.085309965462947, 1.005120169185674),
  'HET': (4.084218683170748, 5.334980002883339),
  'dHET': (2.551897508112834, 6.826367758834428)}}

DictFit_office = {1: {'CM': (22.753107323068875, 3.8130538629132222),
                      'CMB': (12.54214276960203, 6.966324781645193),
                      'HOM': (12.54214276960203, 6.966324781645193),
                      'CMD': (5.9367509227523305, 13.682692154437389),
                      'DYN': (5.398050078381651, 13.52574338529682),
                      'FULL': (167.24266999030968, 0.5184785246424669),
                      'HET': (6.411629467452856, 12.485114464416766),
                      'dCM': (22.267602331627906, 3.8303237963521988),
                      'dHET': (5.353188348839372, 14.103223902894262)},
                     2: {'CM': (6.105840936470259, 15.248791166028376),
                      'CMB': (5.478863300816806, 17.054437599083887),
                      'HOM': (5.478863300816806, 17.054437599083887),
                      'CMD': (4.265899823272366, 19.50186424551633),
                      'DYN': (4.042171341977366, 20.939694451445522),
                      'FULL': (15.240236305405743, 5.818107897490598),
                      'HET': (4.48213057532499, 21.506459629017577),
                      'dCM': (6.398438193120235, 14.413034021896523),
                      'dHET': (4.074315842743239, 21.256640832605427)}}

DictFit_hospital_old = {1: {'CM': (13.40765069682865, 28.246415746000995),
                      'CMB': (12.34587341202436, 30.3175518113381),
                      'CMD': (9.652228523376168, 37.576165338421745),
                      'DYN': (5.310560505716497, 66.20938601488966),
                      'FULL': (30.435088468195104, 12.473246875978358),
                      'HET': (5.661147323231857, 61.0732613231761),
                      'dHET': (5.627662607173818, 61.553859517253414)},
                     2: {'CM': (5.289451003495403, 103.85836192132909),
                      'CMB': (5.151966241028074, 105.6154543461273),
                      'CMD': (4.838466085682976, 107.6962231874766),
                      'DYN': (4.308974455784441, 155.2712756686523),
                      'FULL': (4.584437260682111, 98.33191397611893),
                      'HET': (4.403165163222827, 153.1439405488677),
                      'dHET': (4.391009012878286, 154.50684648385254)}}

DictFit_hospital =  {1: {'CM': (14.389887700330407, 25.959179043796574),
                      'CMB': (12.088606733459985, 30.842289312080236),
                      'CMD': (10.002021075435552, 36.44292028430654),
                      'DYN': (5.113296726722156, 69.60374830136503),
                      'FULL': (33.68218747127286, 11.208948928918634),
                      'HET': (5.326007886518328, 65.78621500824178),
                      'dHET': (5.328889308293487, 65.919571872876)},
                     2: {'CM': (5.833114530908388, 90.61077385559012),
                      'CMB': (5.587613870934145, 94.28089011801904),
                      'CMD': (4.902219700203319, 105.03162162344448),
                      'DYN': (4.281359520021842, 156.64121335265375),
                      'FULL': (6.888772997942802, 56.96212119263045),
                      'HET': (4.330077092044797, 158.65589277883745),
                      'dHET': (4.362858213954707, 156.3781855100947)}}




DictFit_cprepa =    {1: {'CM': (16.65684906731283, 11.552801968768417),
                  'CMB': (16.684833190730057, 11.299954190153366),
                  'CMD': (6.454485567054638, 28.06811254098832),
                  'DYN': (4.53000291021154, 28.90357188976479),
                  'FULL': (128.00810570128297, 1.4654449852305176),
                  'HET': (5.094165781904743, 28.455867263001604),
                  'dHET': (5.056487194789367, 28.469096161825853)},
                 2: {'CM': (4.271913326392458, 49.32459733986877),
                  'CMB': (4.087095573150648, 51.9800084659375),
                  'CMD': (3.5465887929925617, 54.523460266341935),
                  'DYN': (3.164233251663098, 44.34814290035139),
                  'FULL': (22.08586306266488, 8.581230892221907),
                  'HET': (3.3956425303927538, 46.12612233992352),
                  'dHET': (3.4111736041023972, 45.69933886012546)}}

DictFit_school = {1: {'CM': (19.927842029696773, 7.452019188894643),
                      'CMB': (22.57183601340918, 6.051723573136716),
                      'CMD': (17.24565518737762, 7.917185842020132),
                      'DYN': (9.780694299020936, 13.49919379988682),
                      'FULL': (95.52888656594179, 1.499236967529684),
                      'HET': (9.390836055957351, 14.442034276184192),
                      'dHET': (9.655516678105556, 13.96709838896761)},
                     2: {'CM': (5.505933208368795, 28.808242510647972),
                      'CMB': (6.595358045664617, 21.773737866254898),
                      'CMD': (5.990994945368045, 24.218648085779794),
                      'DYN': (4.689423804775642, 32.77413624938016),
                      'FULL': (20.875430809690112, 6.884028911675043),
                      'HET': (4.667142932345139, 33.50916427881252),
                      'dHET': (4.644394001618119, 33.757858284870686)}}
# {1: {'CM': (20.969387434542114, 6.8942395455924395),
#                       'CMB': (21.77608284009822, 6.230152647856561),
#                       'CMD': (13.470871410921028, 10.23742048852637),
#                       'DYN': (9.470822826334116, 13.883685638414232),
#                       'FULL': (71.95506584344716, 1.9381667953366997),
#                       'HET': (8.928809823608939, 15.152109900660383),
#                       'dHET': (9.309524802331447, 14.44050907388385)},
#                      2: {'CM': (6.057340468032101, 25.681359200621284),
#                       'CMB': (6.564087808928006, 21.745123305906112),
#                       'CMD': (6.202599008226217, 22.96070669139915),
#                       'DYN': (4.728637932239597, 32.238439525793815),
#                       'FULL': (21.214295101237063, 6.766787052977158),
#                       'HET': (4.78360402892859, 32.16947174788105),
#                       'dHET': (4.711005153272191, 32.96414001853962)}}



#!!!!!!!!!!!!!!!!!!!!!!!!!!

DictFit_officeSIR = {1: {'CM': (4.380095451229074, 3.7931146859090057),
                          'FULL': (10.23045090525246, 1.5900634196526797),
                          'HET': (2.4576151342586656, 6.030856290665883)},
                         2: {'CM': (2.996376447972028, 7.349731697560077),
                          'FULL': (5.955955003983144, 3.2012518638122622),
                          'HET': (2.7312197350949208, 8.294307310410986)}}

DictFit_ODFIC ={1: {'DYN': [4.38032343, 8.30126657],
                     #'HET':[5.83050786, 6.98395936],
                     'HET':[4.68123059, 9.238035  ],
                     'CM': [13.72854518,  3.29745325]} }

get_dict = {'office': DictFit_office,
            'officeSIR': DictFit_officeSIR,
            'officeFIC': DictFit_ODFIC,
           'hospital': DictFit_hospital,
           'hospitalold': DictFit_hospital_old,
           'school': DictFit_school,
           'cprepa': DictFit_cprepa,
           'office_r025': DictFit_office_rperiod_025,
           'office_r05': DictFit_office_rperiod_05,
           'office_r15': DictFit_office_rperiod_15,
           }


def get_beta_imm(R0,imm,DATA,NET,GEN):
    A0,f = get_dict[DATA][GEN][NET]
    A = A0 * ( 1 - imm )
    return -np.log( 1 - R0/A)/ (f  /(60*24) )


def get_beta(R0,DATA,NET,GEN):
    A,f = get_dict[DATA][GEN][NET]
    return -np.log( 1 - R0/A)/ (f  /(60*24) )

def get_R0(beta,DATA,NET,GEN):
    A,f = get_dict[DATA][GEN][NET]
    return A *( 1 - np.exp(- f * beta /(60*24) ) )



